Описание сервиса CartService

Сервис CartService управляет полной информацией о корзине пользователя в онлайн-магазине.
Он обеспечивает очистку корзины, передачу её содержимого в заказ и получение полной информации о корзине
с подсчётом общей стоимости.

Основные методы:

1. clearCart()
   Очищает корзину текущего пользователя.
   * Получает текущего пользователя через UserService.
   * Удаляет все элементы корзины (cartItems).
   * Сохраняет изменения пользователя через UserRepository.

2. transferCartToOrder()
   Переносит содержимое корзины в новый заказ.
   * Получает текущую корзину и пользователя.
   * Преобразует каждый элемент корзины (CartItem) в элемент заказа (OrderItem).
   * Создаёт новый объект Order, устанавливает пользователя, статус (PENDING_PAYMENT), дату создания и обновления.
   * Сохраняет заказ через OrderRepository и добавляет его в список заказов пользователя.
   * Очищает корзину после успешного переноса данных.

3. getCartFullData()
   Возвращает полную информацию о корзине в виде объекта CartResponseDto.
   * Получает текущего пользователя и корзину.
   * Преобразует все элементы корзины в DTO.
   * Рассчитывает общую стоимость корзины с учётом скидок.
   * Возвращает DTO с идентификатором пользователя, списком товаров и общей суммой.

4. getCurrentCart()
   Возвращает корзину текущего пользователя.
   * Получает пользователя через UserService.
   * Ищет корзину в базе данных через CartRepository.
   * Если корзина отсутствует, выбрасывает исключение BadRequestException("Cart is empty").

5. saveCart(Cart cart)
   Сохраняет корзину пользователя в базе данных.
   * Проверяет, что объект корзины не равен null.
   * Проверяет наличие пользователя и элементов корзины.
   * Сохраняет корзину через CartRepository.


