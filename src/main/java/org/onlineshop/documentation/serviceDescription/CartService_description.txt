Описание сервиса CartService

Сервис CartService отвечает за управление корзиной пользователя,
её содержимым и процессом преобразования корзины в заказ.
Он реализует интерфейс CartServiceInterface и взаимодействует с репозиториями
и другими сервисами для обеспечения целостности данных и корректной бизнес-логики.

Основные зависимости:

* OrderRepository — для сохранения заказов.
* UserService — для получения текущего пользователя.
* CartItemConverter — для преобразования элементов корзины в элементы заказа.
* CartRepository — для сохранения и получения корзин пользователей.
* UserRepository — для обновления данных пользователя.

Основные методы:

1. clearCart()
   Очищает корзину текущего пользователя.
   * Получает текущего пользователя через UserService.
   * Удаляет все элементы корзины (cartItems).
   * Сохраняет изменения пользователя через UserRepository.

2. transferCartToOrder()
   Переносит содержимое корзины в новый заказ.
   * Получает текущую корзину и пользователя.
   * Преобразует каждый элемент корзины (CartItem) в элемент заказа (OrderItem).
   * Создаёт новый объект Order, устанавливает пользователя, статус (PENDING_PAYMENT), дату создания и обновления.
   * Сохраняет заказ через OrderRepository и добавляет его в список заказов пользователя.
   * Очищает корзину после успешного переноса данных.

3. getCartFullData()
   Возвращает полную информацию о корзине в виде объекта CartResponseDto.
   * Получает текущего пользователя и корзину.
   * Преобразует все элементы корзины в DTO.
   * Рассчитывает общую стоимость корзины с учётом скидок.
   * Возвращает DTO с идентификатором пользователя, списком товаров и общей суммой.

4. getCurrentCart()
   Возвращает корзину текущего пользователя.
   * Получает пользователя через UserService.
   * Ищет корзину в базе данных через CartRepository.
   * Если корзина отсутствует, выбрасывает исключение BadRequestException("Cart is empty").

5. saveCart(Cart cart)
   Сохраняет корзину пользователя в базе данных.
   * Проверяет, что объект корзины не равен null.
   * Проверяет наличие пользователя и элементов корзины.
   * Сохраняет корзину через CartRepository.


