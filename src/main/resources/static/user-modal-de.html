<div class="modal-content">
    <div class="modal-header">
        <h2>üë• Benutzerverwaltung Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- Allgemeine Beschreibung -->
        <div class="description-section">
            <h3>Allgemeine Beschreibung</h3>
            <p>
                UserService ist verantwortlich f√ºr die Benutzerverwaltung, einschlie√ülich Registrierung,
                E-Mail-Best√§tigung, Datenaktualisierung, L√∂schung, Benutzerwiederherstellung und Passwortverschl√ºsselung,
                sowie das Abrufen von Informationen √ºber den aktuellen Benutzer. Integriert mit Spring Security und ConfirmationCodeService.
            </p>
        </div>

        <!-- Hauptservice-Methoden -->
        <div class="methods-section">
            <h3>Hauptservice-Methoden</h3>

            <div class="method-card">
                <h4>registration(UserRequestDto request)</h4>
                <p>Registriert einen neuen Benutzer.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft, ob ein Benutzer mit dieser E-Mail bereits existiert</div>
                    <div>‚Ä¢ Validiert erforderliche Felder (Name und hashPassword)</div>
                    <div>‚Ä¢ Erstellt einen neuen Benutzer mit USER-Rolle und NOT_CONFIRMED-Status</div>
                    <div>‚Ä¢ Initialisiert Bestellungen und Favoriten-Sammlungen</div>
                    <div>‚Ä¢ Erstellt Warenkorb f√ºr den Benutzer</div>
                    <div>‚Ä¢ Speichert den Benutzer in der Datenbank</div>
                    <div>‚Ä¢ Generiert und sendet Best√§tigungscode √ºber confirmationCodeService</div>
                    <div>‚Ä¢ Gibt UserResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>confirmationEmail(String code)</h4>
                <p>Best√§tigt Benutzer-E-Mail mit dem Code.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validiert Best√§tigungscode</div>
                    <div>‚Ä¢ Pr√ºft Ablaufdatum des Best√§tigungscodes</div>
                    <div>‚Ä¢ Wenn Code abgelaufen - generiert neuen und sendet an Benutzer</div>
                    <div>‚Ä¢ √Ñndert Benutzerstatus auf CONFIRMED</div>
                    <div>‚Ä¢ Speichert den Benutzer</div>
                    <div>‚Ä¢ Gibt Erfolgsbest√§tigungsnachricht zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateUser(Integer userId, UserUpdateRequestDto updateRequest)</h4>
                <p>Aktualisiert Benutzerdaten.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft, ob der Benutzer existiert</div>
                    <div>‚Ä¢ Verifiziert, dass die Aktualisierung vom aktuellen Benutzer durchgef√ºhrt wird</div>
                    <div>‚Ä¢ Aktualisiert bereitgestellte Felder (username, phoneNumber, hashPassword)</div>
                    <div>‚Ä¢ Verschl√ºsselt Passwort √ºber PasswordEncoder bei Aktualisierung</div>
                    <div>‚Ä¢ Speichert √Ñnderungen</div>
                    <div>‚Ä¢ Gibt UserResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>deleteUser(Integer userId)</h4>
                <p>F√ºhrt logisches L√∂schen des Benutzers durch.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft, ob der Benutzer existiert</div>
                    <div>‚Ä¢ Verhindert ADMIN-Benutzerl√∂schung</div>
                    <div>‚Ä¢ √úberpr√ºft aktuelle Benutzerberechtigungen</div>
                    <div>‚Ä¢ L√∂scht Benutzerbest√§tigungscodes √ºber confirmationCodeService</div>
                    <div>‚Ä¢ √Ñndert Status auf DELETED</div>
                    <div>‚Ä¢ Speichert den Benutzer</div>
                    <div>‚Ä¢ Gibt UserResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>renewUser(String email)</h4>
                <p>Stellt einen gel√∂schten Benutzer wieder her.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validiert E-Mail</div>
                    <div>‚Ä¢ Pr√ºft, dass der Benutzer gel√∂scht ist (DELETED-Status)</div>
                    <div>‚Ä¢ Generiert neuen Best√§tigungscode</div>
                    <div>‚Ä¢ √Ñndert Status auf NOT_CONFIRMED</div>
                    <div>‚Ä¢ Speichert den Benutzer</div>
                    <div>‚Ä¢ Gibt UserResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getAllUsers(Pageable pageable)</h4>
                <p>Ruft paginierte Benutzerliste ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Gibt Seite mit UserResponseDto zur√ºck</div>
                    <div>‚Ä¢ Verwendet Paginierung √ºber Pageable</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getCurrentUser()</h4>
                <p>Ruft den aktuellen authentifizierten Benutzer ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Verwendet Spring-Security-Mechanismen zum Abrufen des aktuellen Benutzers</div>
                    <div>‚Ä¢ Gibt aktuelle Benutzerdaten zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getUserByEmail(String email)</h4>
                <p>Ruft Benutzer per E-Mail-Adresse ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Sucht Benutzer nach E-Mail</div>
                    <div>‚Ä¢ Gibt UserResponseDto zur√ºck</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/users/register</span>
                    <span class="role-badge role-public">PUBLIC</span>
                </div>
                <p>Registriert einen neuen Benutzer. Benutzer erh√§lt E-Mail mit Best√§tigungscode.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/users/login</span>
                    <span class="role-badge role-public">PUBLIC</span>
                </div>
                <p>Benutzerauthentifizierung und JWT-Token-Abruf.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/users/confirmation?code={code}</span>
                    <span class="role-badge role-public">PUBLIC</span>
                </div>
                <p>E-Mail-Adressenbest√§tigung mit Best√§tigungscode. Generiert automatisch neuen Code bei Ablauf.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method put">PUT</span>
                    <span class="endpoint-path">/v1/users/{userId}</span>
                    <span class="role-badge role-user">USER, MANAGER, ADMIN</span>
                </div>
                <p>Aktualisiert Benutzerinformationen. Benutzer k√∂nnen nur ihr eigenes Profil aktualisieren. Passwort automatisch verschl√ºsselt.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/users/{userId}</span>
                    <span class="role-badge role-user">USER, MANAGER, ADMIN</span>
                </div>
                <p>L√∂scht Benutzerkonto logisch. ADMIN kann jeden Benutzer au√üer andere ADMINS l√∂schen. L√∂scht zugeh√∂rige Best√§tigungscodes.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/users/renew/{email}</span>
                    <span class="role-badge role-user">USER, MANAGER, ADMIN</span>
                </div>
                <p>Stellt gel√∂schtes Benutzerkonto wieder her. Generiert neuen Best√§tigungscode.</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/users/admin/all?page=0&size=20</span>
                    <span class="role-badge role-admin">ADMIN</span>
                </div>
                <p>Ruft paginierte Liste aller Benutzer ab. Nur f√ºr Administratoren.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Parameter: page (Standard 0), size (Standard 20)</div>
                </div>
            </div>
        </div>

        <!-- Implementierungsmerkmale -->
        <div class="features-section">
            <h3>üîß Implementierungsmerkmale</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Passwortsicherheit:</strong> Passw√∂rter werden √ºber PasswordEncoder verschl√ºsselt</div>
                    <div>‚Ä¢ <strong>E-Mail-Best√§tigung:</strong> Obligatorische E-Mail-Best√§tigung vor Kontaktivierung</div>
                    <div>‚Ä¢ <strong>Berechtigungstrennung:</strong> Unterschiedliche Zugriffsebenen f√ºr Benutzer, MANAGER und ADMIN</div>
                    <div>‚Ä¢ <strong>Logisches L√∂schen:</strong> Benutzer werden als DELETED markiert statt physisch gel√∂scht</div>
                    <div>‚Ä¢ <strong>Kontowiederherstellung:</strong> M√∂glichkeit, gel√∂schte Konten wiederherzustellen</div>
                    <div>‚Ä¢ <strong>Spring Security:</strong> Integration mit Spring Security f√ºr Authentifizierung und Autorisierung</div>
                    <div>‚Ä¢ <strong>Paginierung:</strong> Paginierungsunterst√ºtzung f√ºr Benutzerlisten</div>
                    <div>‚Ä¢ <strong>Code-Validierung:</strong> Automatische Pr√ºfung des Ablaufdatums von Best√§tigungscodes</div>
                    <div>‚Ä¢ <strong>Warenkorb-Integration:</strong> Automatische Warenkorberstellung w√§hrend der Registrierung</div>
                </div>
            </div>
        </div>

        <!-- Gesch√§ftslogik -->
        <div class="business-logic-section">
            <h3>üíº Gesch√§ftslogik</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Registrierung:</strong> Registrierungsprozess mit E-Mail-Best√§tigung f√ºr Sicherheit</div>
                    <div>‚Ä¢ <strong>Authentifizierung:</strong> JWT-basierte Authentifizierung f√ºr sicheren Zugriff</div>
                    <div>‚Ä¢ <strong>Profilverwaltung:</strong> Benutzer k√∂nnen ihre Daten aktualisieren</div>
                    <div>‚Ä¢ <strong>Zugriffskontrolle:</strong> Unterschiedliche Rollen mit verschiedenen Berechtigungsebenen</div>
                    <div>‚Ä¢ <strong>Wiederherstellung:</strong> Mechanismus zur Wiederherstellung gel√∂schter Konten</div>
                    <div>‚Ä¢ <strong>Administration:</strong> Separate Methoden f√ºr administrative Verwaltung</div>
                    <div>‚Ä¢ <strong>Benutzerstatus:</strong> NOT_CONFIRMED ‚Üí CONFIRMED ‚Üí DELETED ‚Üí NOT_CONFIRMED</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Schlie√üen</button>
    </div>
</div>