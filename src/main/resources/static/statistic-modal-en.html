<div class="modal-content">
    <div class="modal-header">
        <h2>ðŸ“Š Statistics and Analytics Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- General Description -->
        <div class="description-section">
            <h3>General Description</h3>
            <p>
                StatisticService is responsible for getting statistics on products and profit.
                Performs operations for counting most sold, cancelled products, products in payment pending status,
                as well as calculating profit for selected period. Provides analytical data for business decisions.
            </p>
        </div>

        <!-- Main Service Methods -->
        <div class="methods-section">
            <h3>Main Service Methods</h3>

            <div class="method-card">
                <h4>getTopTenPurchasedProducts()</h4>
                <p>Gets list of 10 most purchased products with PAID status.</p>
                <div class="method-steps">
                    <div>â€¢ Calls private method getTopTenProducts(Order.Status.PAID)</div>
                    <div>â€¢ Returns list of ProductStatisticResponseDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getTenCanceledProducts()</h4>
                <p>Gets list of 10 products with cancelled orders.</p>
                <div class="method-steps">
                    <div>â€¢ Calls private method getTopTenProducts(Order.Status.CANCELLED)</div>
                    <div>â€¢ Returns list of ProductStatisticResponseDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getProductsInPendingPaymentStatus(Integer days)</h4>
                <p>Gets products with orders in PENDING_PAYMENT status for last N days.</p>
                <div class="method-steps">
                    <div>â€¢ Calculates period start date</div>
                    <div>â€¢ Creates productQuantityMap for counting each product quantity</div>
                    <div>â€¢ Gets orders with PENDING_PAYMENT status created after startDate</div>
                    <div>â€¢ Counts quantity of each product in orders</div>
                    <div>â€¢ Converts map to ProductStatisticResponseDto list via ProductConverter</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getProfitStatistics(ProfitStatisticRequestDto request)</h4>
                <p>Gets profit statistics for period with grouping by hour, day, week or month.</p>
                <div class="method-steps">
                    <div>â€¢ Validates period unit (DAYS, WEEKS, MONTHS, YEARS) and groupBy (HOUR, DAY, WEEK, MONTH)</div>
                    <div>â€¢ Determines startDate and endDate</div>
                    <div>â€¢ Gets orders with PAID status after startDate</div>
                    <div>â€¢ Groups profit by key depending on groupBy</div>
                    <div>â€¢ Calculates totalProfit</div>
                    <div>â€¢ Returns ProfitStatisticsResponseDto with profit data</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getTopTenProducts(Order.Status orderStatus) [private]</h4>
                <p>Gets top-10 products by sales quantity for specified order status.</p>
                <div class="method-steps">
                    <div>â€¢ Creates productTopTenProducts map for counting each product quantity</div>
                    <div>â€¢ Gets all orders with specified status</div>
                    <div>â€¢ Sums product quantities by orders</div>
                    <div>â€¢ Sorts in descending order and keeps first 10</div>
                    <div>â€¢ Converts to ProductStatisticResponseDto list via ProductConverter</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/statistics/topSold</span>
                    <span class="role-badge role-admin">ADMIN</span>
                </div>
                <p>Get top-10 most sold products</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/statistics/topCanceled</span>
                    <span class="role-badge role-admin">ADMIN</span>
                </div>
                <p>Get top-10 most cancelled products</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/statistics/pendingPayment/{days}</span>
                    <span class="role-badge role-admin">ADMIN</span>
                </div>
                <p>Get products with pending payments for last N days</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/statistics/profit</span>
                    <span class="role-badge role-admin">ADMIN</span>
                </div>
                <p>Get profit statistics for specified period with grouping</p>
            </div>
        </div>

        <!-- Implementation Features -->
        <div class="features-section">
            <h3>ðŸ”§ Implementation Features</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Flexible Grouping:</strong> Support for various grouping periods (hour, day, week, month)</div>
                    <div>â€¢ <strong>Efficient Queries:</strong> Optimized SQL queries for working with large data volumes</div>
                    <div>â€¢ <strong>Parameter Validation:</strong> Checking period and grouping criteria correctness</div>
                    <div>â€¢ <strong>Real-time Statistics:</strong> Current data based on actual orders</div>
                    <div>â€¢ <strong>Scalability:</strong> Ability to process large volumes of historical data</div>
                    <div>â€¢ <strong>Security:</strong> Access only for system administrators</div>
                </div>
            </div>
        </div>

        <!-- Business Logic -->
        <div class="business-logic-section">
            <h3>ðŸ’¼ Business Logic</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Sales Analysis:</strong> Identifying most popular and problematic products</div>
                    <div>â€¢ <strong>Inventory Management:</strong> Data for optimizing warehouse stocks</div>
                    <div>â€¢ <strong>Financial Analysis:</strong> Detailed profit statistics by periods</div>
                    <div>â€¢ <strong>Problem Identification:</strong> Analysis of cancelled orders for service improvement</div>
                    <div>â€¢ <strong>Planning:</strong> Data for sales forecasting and procurement</div>
                </div>
            </div>
        </div>

        <!-- Metrics and Indicators -->
        <div class="metrics-section">
            <h3>ðŸ“ˆ Key Metrics</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Top Sales:</strong> 10 most sold products</div>
                    <div>â€¢ <strong>Top Cancellations:</strong> 10 most cancelled products</div>
                    <div>â€¢ <strong>Pending Payments:</strong> Products in orders with PENDING_PAYMENT status</div>
                    <div>â€¢ <strong>Profit by Periods:</strong> Profit grouping by hours, days, weeks, months</div>
                    <div>â€¢ <strong>Total Profit:</strong> Total profit for selected period</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Close</button>
    </div>
</div>