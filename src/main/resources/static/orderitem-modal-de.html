<div class="modal-content">
    <div class="modal-header">
        <h2>üì¶ Bestellpositionen Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- Allgemeine Beschreibung -->
        <div class="description-section">
            <h3>Allgemeine Beschreibung</h3>
            <p>
                OrderItemService ist verantwortlich f√ºr die Verwaltung von Produkten, die zu Benutzerbestellungen hinzugef√ºgt wurden.
                F√ºhrt Operationen zum Hinzuf√ºgen, L√∂schen und Aktualisieren von Produktmengen in der aktuellen Benutzerbestellung
                mit PENDING_PAYMENT-Status durch. Bietet flexible Verwaltung des Bestellinhalts bis zum Zahlungszeitpunkt.
            </p>
        </div>

        <!-- Hauptservice-Methoden -->
        <div class="methods-section">
            <h3>Hauptservice-Methoden</h3>

            <div class="method-card">
                <h4>addItemToOrder(OrderItemRequestDto dto)</h4>
                <p>F√ºgt Produkt zur aktuellen offenen Bestellung des Benutzers hinzu.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validiert Eingabedaten</div>
                    <div>‚Ä¢ Pr√ºft, dass productId und Menge nicht null sind und Menge gr√∂√üer als null ist</div>
                    <div>‚Ä¢ Findet Produkt nach bereitgestellter productId in ProductRepository</div>
                    <div>‚Ä¢ Berechnet Preis zum Kaufzeitpunkt - wenn Produkt Rabatt hat, wird Preis mit Rabatt angewendet</div>
                    <div>‚Ä¢ Erstellt neues OrderItem-Objekt, f√ºgt es zur aktuellen Bestellung hinzu und speichert in Datenbank</div>
                    <div>‚Ä¢ Gibt DTO der hinzugef√ºgten Bestellposition (OrderItemResponseDto) zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>deleteItemFromOrder(Integer orderItemId)</h4>
                <p>L√∂scht bestimmtes Produkt aus Bestellung nach Bestellpositionsidentifikator.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft, dass orderItemId nicht null ist</div>
                    <div>‚Ä¢ Findet entsprechendes Element in OrderItemRepository</div>
                    <div>‚Ä¢ L√∂scht Element aus orderItems-Sammlung der aktuellen Bestellung (orphanRemoval-Mechanismus enthalten)</div>
                    <div>‚Ä¢ L√∂scht Element aus Datenbank und speichert aktualisierte Bestellung</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateItemQuantityInOrder(OrderItemUpdateDto dto)</h4>
                <p>Aktualisiert Menge eines bestimmten Produkts in Benutzerbestellung.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validiert Eingabedaten (dto != null, Menge > 0)</div>
                    <div>‚Ä¢ Pr√ºft, ob Bestellposition nach orderItemId existiert</div>
                    <div>‚Ä¢ Pr√ºft, ob Bestellung zum aktuellen Benutzer geh√∂rt (verhindert √Ñnderung fremder Bestellung)</div>
                    <div>‚Ä¢ Aktualisiert Produktmenge, speichert √Ñnderungen in OrderItemRepository</div>
                    <div>‚Ä¢ Gibt aktualisierte Bestellposition als DTO (OrderItemResponseDto) zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getCurrentOrder() [private Methode]</h4>
                <p>Gibt aktuelle offene Bestellung des Benutzers zur√ºck.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Ruft aktuellen Benutzer √ºber UserService ab</div>
                    <div>‚Ä¢ Sucht unter Benutzerbestellungen nach der mit PENDING_PAYMENT-Status</div>
                    <div>‚Ä¢ Wenn solche Bestellung nicht gefunden - wirft NotFoundException</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/orderItems/{orderItemId}</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>L√∂scht Produkt aus Bestellung nach Bestellpositions-ID</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method put">PUT</span>
                    <span class="endpoint-path">/v1/orderItems</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Aktualisiert Produktmenge in Bestellung</p>
            </div>
        </div>

        <!-- Implementierungsmerkmale -->
        <div class="features-section">
            <h3>üîß Implementierungsmerkmale</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Sicherheit:</strong> √úberpr√ºfung der Bestellungszugeh√∂rigkeit zum aktuellen Benutzer</div>
                    <div>‚Ä¢ <strong>Feste Preise:</strong> Produktpreis wird beim Hinzuf√ºgen zur Bestellung festgelegt</div>
                    <div>‚Ä¢ <strong>Rabattber√ºcksichtigung:</strong> Automatische Rabattanwendung bei Preisberechnung</div>
                    <div>‚Ä¢ <strong>Orphan Removal:</strong> Automatisches L√∂schen von Elementen bei Entfernung aus Sammlung</div>
                    <div>‚Ä¢ <strong>Validierung:</strong> √úberpr√ºfung der Mengenkorrektheit und Produktexistenz</div>
                    <div>‚Ä¢ <strong>Einschr√§nkungen:</strong> √Ñnderungen nur f√ºr Bestellungen mit PENDING_PAYMENT-Status m√∂glich</div>
                </div>
            </div>
        </div>

        <!-- Gesch√§ftslogik -->
        <div class="business-logic-section">
            <h3>üíº Gesch√§ftslogik</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Preispolitik:</strong> Preise werden beim Hinzuf√ºgen zur Bestellung festgelegt, sch√ºtzt vor √Ñnderungen</div>
                    <div>‚Ä¢ <strong>√Ñnderungsflexibilit√§t:</strong> Benutzer kann Bestellinhalt bis zum Zahlungszeitpunkt √§ndern</div>
                    <div>‚Ä¢ <strong>Integrit√§tskontrolle:</strong> √úberpr√ºfung der Produktexistenz vor Hinzuf√ºgen zur Bestellung</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Schlie√üen</button>
    </div>
</div>