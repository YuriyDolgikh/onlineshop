<div class="modal-content">
    <div class="modal-header">
        <h2>üìù Cart Items Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- General Description -->
        <div class="description-section">
            <h3>General Description</h3>
            <p>
                CartItemService is responsible for managing products in user's cart.
                It provides adding, removing, updating and retrieving cart items (CartItem),
                ensures convenient user work with shopping cart, automatically creating it when necessary
                and synchronizing data between Order (cart) and OrderItem (cart positions) entities.
            </p>
        </div>

        <!-- Main Service Methods -->
        <div class="methods-section">
            <h3>Main Service Methods</h3>

            <div class="method-card">
                <h4>addItemToCart(CartItemRequestDto)</h4>
                <p>Adds product to current user's cart.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validates input data (presence of productId and quantity)</div>
                    <div>‚Ä¢ Gets current user from security context</div>
                    <div>‚Ä¢ Checks if product is already in cart</div>
                    <div>‚Ä¢ If product found - increases quantity</div>
                    <div>‚Ä¢ If not - creates new OrderItem linked to open order (Order)</div>
                    <div>‚Ä¢ Saves changes and returns DTO of added product</div>
                </div>
            </div>

            <div class="method-card">
                <h4>removeItemFromCart(Integer productId)</h4>
                <p>Removes specific product from user's cart.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validates ID correctness</div>
                    <div>‚Ä¢ Gets user and current cart</div>
                    <div>‚Ä¢ Finds OrderItem element and deletes it from repository</div>
                    <div>‚Ä¢ Returns DTO of deleted element</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateItemInCart(CartItemUpdateDto)</h4>
                <p>Updates product quantity in cart.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Validates data (presence of productId and quantity > 0)</div>
                    <div>‚Ä¢ Finds required OrderItem</div>
                    <div>‚Ä¢ Sets new quantity and saves changes</div>
                    <div>‚Ä¢ Returns updated DTO</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getCartItems()</h4>
                <p>Returns all cart items of current user.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Gets user and their open cart</div>
                    <div>‚Ä¢ Converts list of OrderItem to list of CartItemResponseDto and returns to client</div>
                </div>
            </div>
        </div>

        <!-- Helper Methods -->
        <div class="methods-section">
            <h3>Helper Methods</h3>

            <div class="method-card">
                <h4>getCurrentCart(User user)</h4>
                <p>Returns user's open cart.</p>
                <div class="method-steps">
                    <div>‚Ä¢ If cart exists and has OPEN status - returns it</div>
                    <div>‚Ä¢ If cart doesn't exist - creates new cart (Order) with OPEN status and saves to database</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getOrderItemFromCart(User user, Integer productId)</h4>
                <p>Returns specific cart item by product ID.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Searches OrderItem in user's open order</div>
                    <div>‚Ä¢ If element not found - throws IllegalArgumentException</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/cartItems</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Add new product to user's cart</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/cartItems/{productId}</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Remove specific product from cart by product ID</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method put">PUT</span>
                    <span class="endpoint-path">/v1/cartItems</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Update product quantity in cart</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/cartItems</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Get all cart items of current user</p>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Close</button>
    </div>
</div>