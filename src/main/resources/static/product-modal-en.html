<div class="modal-content">
    <div class="modal-header">
        <h2>ðŸ“¦ Product Management Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- General Description -->
        <div class="description-section">
            <h3>General Description</h3>
            <p>
                ProductService is responsible for product management.
                Performs operations for adding, updating, deleting and retrieving products with various filtering and sorting criteria.
                Provides full cycle of product catalog management for the store with pagination support.
            </p>
        </div>

        <!-- Main Service Methods -->
        <div class="methods-section">
            <h3>Main Service Methods</h3>

            <div class="method-card">
                <h4>addProduct(ProductRequestDto productRequestDto)</h4>
                <p>Adds a new product.</p>
                <div class="method-steps">
                    <div>â€¢ Validates product request data (name length, price > 0, etc.)</div>
                    <div>â€¢ Gets category by name from CategoryService</div>
                    <div>â€¢ Checks that product with this name doesn't exist in the category</div>
                    <div>â€¢ Resolves image URL using ProductServiceHelper</div>
                    <div>â€¢ Creates Product object with current timestamp and saves via ProductRepository</div>
                    <div>â€¢ Handles race conditions with DataIntegrityViolationException</div>
                    <div>â€¢ Returns ProductResponseDto via ProductConverter</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateProduct(Integer productId, ProductUpdateDto productUpdateDto)</h4>
                <p>Updates data of existing product.</p>
                <div class="method-steps">
                    <div>â€¢ Finds product by ID, if not found - throws IllegalArgumentException</div>
                    <div>â€¢ Validates new category and name uniqueness within category</div>
                    <div>â€¢ Updates category, name, description, price, discount and image</div>
                    <div>â€¢ Validates data correctness (name length 3-20, price > 0, etc.)</div>
                    <div>â€¢ Updates modification timestamp</div>
                    <div>â€¢ Saves product via ProductRepository</div>
                    <div>â€¢ Returns ProductResponseDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>setDiscountPrice(Integer productId, BigDecimal newDiscountPrice)</h4>
                <p>Sets new discount for product.</p>
                <div class="method-steps">
                    <div>â€¢ Validates productId and newDiscountPrice are not null</div>
                    <div>â€¢ Validates discount price is not negative</div>
                    <div>â€¢ Finds product by ID</div>
                    <div>â€¢ Sets discountPrice and updates timestamp</div>
                    <div>â€¢ Saves product and returns ProductResponseDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>deleteProduct(Integer productId)</h4>
                <p>Deletes product.</p>
                <div class="method-steps">
                    <div>â€¢ Finds product by ID</div>
                    <div>â€¢ Deletes it via ProductRepository</div>
                    <div>â€¢ Returns ProductResponseDto of deleted product</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getProductsByCriteria(String paramName, String paramValue, Pageable pageable)</h4>
                <p>Gets paginated list of products by specified criteria.</p>
                <div class="method-steps">
                    <div>â€¢ Processes parameters: price, discount, category, name, createDate</div>
                    <div>â€¢ For price: parses range from "minPrice-maxPrice" format</div>
                    <div>â€¢ Calls corresponding repository methods with pagination</div>
                    <div>â€¢ Returns Page of ProductResponseDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getProductsForUser(Pageable pageable)</h4>
                <p>Gets paginated list of products for regular users.</p>
                <div class="method-steps">
                    <div>â€¢ Retrieves all products with pagination</div>
                    <div>â€¢ Converts to ProductResponseForUserDto (simplified view)</div>
                    <div>â€¢ Returns Page of ProductResponseForUserDto</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getTopFiveDiscountedProductsOfTheDay()</h4>
                <p>Gets top-5 products with highest discount.</p>
                <div class="method-steps">
                    <div>â€¢ Creates PageRequest for 5 items sorted by discount descending</div>
                    <div>â€¢ Finds products with discountPrice greater than zero</div>
                    <div>â€¢ Converts to ProductResponseForUserDto list</div>
                    <div>â€¢ Throws NotFoundException if no discounted products found</div>
                    <div>â€¢ Returns list of ProductResponseForUserDto</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/products</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Create new product (requires MANAGER or ADMIN role)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method put">PUT</span>
                    <span class="endpoint-path">/v1/products/{productId}</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Update product data (requires MANAGER or ADMIN role)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/products/{productId}</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Delete product (requires MANAGER or ADMIN role)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/products/updateProductDiscount/{productId}/{newDiscount}</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Update discount for product (requires MANAGER or ADMIN role)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/products</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Get all products with full details (requires MANAGER or ADMIN role)</p>
                <div class="endpoint-params">
                    <strong>Parameters:</strong> page, size, sort, direction
                </div>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/products/getAllProductForUser</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Get all products with simplified information for users</p>
                <div class="endpoint-params">
                    <strong>Parameters:</strong> page, size, sort, direction
                </div>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/products/getProductsByCriteria</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Search products by criteria (price, category, name, etc.)</p>
                <div class="endpoint-params">
                    <strong>Parameters:</strong> paramName, paramValue, sortDirection, page, size
                </div>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/products/getTopFiveProducts</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Get top-5 products with highest discounts</p>
            </div>
        </div>

        <!-- Implementation Features -->
        <div class="features-section">
            <h3>ðŸ”§ Implementation Features</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Permission Separation:</strong> Different access levels for users, MANAGER and ADMIN</div>
                    <div>â€¢ <strong>Pagination Support:</strong> All list operations support pagination and sorting</div>
                    <div>â€¢ <strong>Flexible Search:</strong> Support for multiple filtering criteria with automatic parameter handling</div>
                    <div>â€¢ <strong>Data Validation:</strong> Comprehensive validation of prices, discounts, names and categories</div>
                    <div>â€¢ <strong>Product Uniqueness:</strong> Guarantee of unique product name within category with race condition protection</div>
                    <div>â€¢ <strong>Image Handling:</strong> Automatic image URL resolution and validation</div>
                    <div>â€¢ <strong>Timestamp Management:</strong> Automatic creation and update timestamp handling</div>
                </div>
            </div>
        </div>

        <!-- Business Logic -->
        <div class="business-logic-section">
            <h3>ðŸ’¼ Business Logic</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Pricing Policy:</strong> Support for regular prices and discount prices with validation</div>
                    <div>â€¢ <strong>Categorization:</strong> Clear organization of products by categories with uniqueness enforcement</div>
                    <div>â€¢ <strong>Promotions:</strong> Top-5 discounted products mechanism for sales stimulation</div>
                    <div>â€¢ <strong>Management Flexibility:</strong> Ability to quickly update prices, discounts and product information</div>
                    <div>â€¢ <strong>Search and Filtering:</strong> Convenient product search by price ranges, categories, names and creation dates</div>
                    <div>â€¢ <strong>User Experience:</strong> Separate views for administrators (full details) and users (simplified information)</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Close</button>
    </div>
</div>