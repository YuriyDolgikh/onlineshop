<div class="modal-content">
    <div class="modal-header">
        <h2>ðŸ›’ Shopping Cart Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- General Description -->
        <div class="description-section">
            <h3>General Description</h3>
            <p>
                The cart module is responsible for managing products that the user plans to purchase.
                Includes functions for adding, removing, changing product quantities, as well as
                converting cart to order. Integrated with discount system and order management.
            </p>
        </div>

        <!-- Main Service Methods -->
        <div class="methods-section">
            <h3>Main Service Methods</h3>

            <div class="method-card">
                <h4>clearCart()</h4>
                <p>Clears current user's cart.</p>
                <div class="method-steps">
                    <div>â€¢ Gets current user via UserService</div>
                    <div>â€¢ Deletes all cart items</div>
                    <div>â€¢ Saves user changes via UserRepository</div>
                </div>
            </div>

            <div class="method-card">
                <h4>transferCartToOrder()</h4>
                <p>Transfers cart contents to new order.</p>
                <div class="method-steps">
                    <div>â€¢ Gets current cart and user</div>
                    <div>â€¢ Checks that cart is not empty</div>
                    <div>â€¢ Validates discountPrice presence for all products</div>
                    <div>â€¢ Checks absence of orders with PENDING_PAYMENT status</div>
                    <div>â€¢ Converts CartItem to OrderItem via cartItemConverter</div>
                    <div>â€¢ Creates new Order object with PENDING_PAYMENT status</div>
                    <div>â€¢ Sets DeliveryMethod.PICKUP by default</div>
                    <div>â€¢ Sets created_at and updated_at timestamps</div>
                    <div>â€¢ Saves order via OrderRepository</div>
                    <div>â€¢ Clears cart after successful transfer</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getCartFullData()</h4>
                <p>Returns full cart information as CartResponseDto.</p>
                <div class="method-steps">
                    <div>â€¢ Gets current user and cart</div>
                    <div>â€¢ Converts cart items to CartItemResponseDto</div>
                    <div>â€¢ Calculates total cost considering discounts</div>
                    <div>â€¢ Converts to CartItemSympleResponseDto for response</div>
                    <div>â€¢ Calculation formula: (price * quantity) * (100 - discountPrice) / 100</div>
                    <div>â€¢ Returns DTO with ID, product list and total amount</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getCurrentCart()</h4>
                <p>Returns current user's cart.</p>
                <div class="method-steps">
                    <div>â€¢ Gets user via UserService</div>
                    <div>â€¢ Checks that cart is not null</div>
                    <div>â€¢ Searches cart via CartRepository</div>
                    <div>â€¢ If cart is absent - BadRequestException("Cart is empty")</div>
                </div>
            </div>

            <div class="method-card">
                <h4>saveCart(Cart cart)</h4>
                <p>Saves user's cart to database.</p>
                <div class="method-steps">
                    <div>â€¢ Checks that cart object is not null</div>
                    <div>â€¢ Checks presence of user and cart items</div>
                    <div>â€¢ Saves cart via CartRepository</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/carts</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Get full information about current user's cart with total cost calculation including discounts</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/carts</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Clear entire current user's cart</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/carts/toOrder</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Convert cart to order with subsequent cart clearing. Checks absence of pending orders.</p>
            </div>
        </div>

        <!-- Implementation Features -->
        <div class="features-section">
            <h3>ðŸ”§ Implementation Features</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Discount System:</strong> Automatic cost calculation considering discountPrice</div>
                    <div>â€¢ <strong>Data Validation:</strong> Checking required fields before operations</div>
                    <div>â€¢ <strong>Data Conversion:</strong> Using CartItemConverter for transformation between DTO and Entity</div>
                    <div>â€¢ <strong>Order Management:</strong> Integration with OrderRepository for order creation</div>
                    <div>â€¢ <strong>Order Statuses:</strong> Support for PENDING_PAYMENT status for new orders</div>
                    <div>â€¢ <strong>Delivery Methods:</strong> Using DeliveryMethod.PICKUP by default</div>
                    <div>â€¢ <strong>Transaction Safety:</strong> All critical operations performed within transactions</div>
                </div>
            </div>
        </div>

        <!-- Business Logic -->
        <div class="business-logic-section">
            <h3>ðŸ’¼ Business Logic</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Shopping Cart:</strong> Temporary storage of products before order placement</div>
                    <div>â€¢ <strong>Order Processing:</strong> Converting cart to order with validations</div>
                    <div>â€¢ <strong>Discount System:</strong> Automatic application of discounts to products</div>
                    <div>â€¢ <strong>State Management:</strong> Preventing duplicate order creation</div>
                    <div>â€¢ <strong>Cost Calculation:</strong> Accurate total amount calculation considering quantity and discounts</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Close</button>
    </div>
</div>