<div class="modal-content">
    <div class="modal-header">
        <h2>ðŸ“¦ Order Items Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- General Description -->
        <div class="description-section">
            <h3>General Description</h3>
            <p>
                OrderItemService is responsible for managing individual items within user orders.
                Performs operations for deleting and updating product quantities in orders
                with PENDING_PAYMENT status. Provides management of order contents until payment moment.
            </p>
        </div>

        <!-- Main Service Methods -->
        <div class="methods-section">
            <h3>Main Service Methods</h3>

            <div class="method-card">
                <h4>deleteItemFromOrder(Integer orderItemId)</h4>
                <p>Deletes specific product from order by order item identifier.</p>
                <div class="method-steps">
                    <div>â€¢ Checks that orderItemId is not null</div>
                    <div>â€¢ Finds corresponding order item in OrderItemRepository</div>
                    <div>â€¢ Validates that order is in PENDING_PAYMENT status</div>
                    <div>â€¢ Checks that order belongs to current user</div>
                    <div>â€¢ Removes item from order's orderItems collection</div>
                    <div>â€¢ Deletes item from database and saves updated order</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateItemQuantityInOrder(OrderItemUpdateDto dto)</h4>
                <p>Updates quantity of specific product in user's order.</p>
                <div class="method-steps">
                    <div>â€¢ Validates input data (dto != null)</div>
                    <div>â€¢ Finds order item by orderItemId from dto</div>
                    <div>â€¢ Validates that quantity is at least 1</div>
                    <div>â€¢ Checks if order belongs to current user</div>
                    <div>â€¢ Validates that order is in PENDING_PAYMENT status</div>
                    <div>â€¢ Updates product quantity and saves changes</div>
                    <div>â€¢ Returns updated order item as DTO (OrderItemResponseDto)</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/orderItems/{orderItemId}</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Delete product from order by order item ID</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method put">PUT</span>
                    <span class="endpoint-path">/v1/orderItems</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Update product quantity in order</p>
            </div>
        </div>

        <!-- Implementation Features -->
        <div class="features-section">
            <h3>ðŸ”§ Implementation Features</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Security:</strong> Checking order ownership by current user</div>
                    <div>â€¢ <strong>Status Validation:</strong> Operations allowed only for orders with PENDING_PAYMENT status</div>
                    <div>â€¢ <strong>Data Integrity:</strong> Automatic removal from order collection when deleting items</div>
                    <div>â€¢ <strong>Validation:</strong> Checking quantity correctness and order item existence</div>
                    <div>â€¢ <strong>Error Handling:</strong> Detailed exceptions for various error scenarios</div>
                </div>
            </div>
        </div>

        <!-- Business Logic -->
        <div class="business-logic-section">
            <h3>ðŸ’¼ Business Logic</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>â€¢ <strong>Order Modification:</strong> Users can modify order contents until payment is confirmed</div>
                    <div>â€¢ <strong>Ownership Control:</strong> Users can only manage items in their own orders</div>
                    <div>â€¢ <strong>Status Workflow:</strong> Order items become immutable after payment confirmation</div>
                    <div>â€¢ <strong>Quantity Control:</strong> Minimum quantity of 1 enforced for all order items</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Close</button>
    </div>
</div>