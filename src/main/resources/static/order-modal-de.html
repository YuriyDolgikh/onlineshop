<div class="modal-content">
    <div class="modal-header">
        <h2>üìã Bestellverwaltung Details</h2>
        <button onclick="closeModal()" class="modal-close-btn">&times;</button>
    </div>

    <div class="modal-body">
        <!-- Allgemeine Beschreibung -->
        <div class="description-section">
            <h3>Allgemeine Beschreibung</h3>
            <p>
                OrderService ist verantwortlich f√ºr die Verwaltung von Benutzerbestellungen.
                F√ºhrt Operationen zum Abrufen, Aktualisieren des Status, Stornieren und Best√§tigen von Bestellzahlungen durch.
                Bietet vollst√§ndigen Bestelllebenszyklus von der Erstellung bis zum Abschluss.
            </p>
        </div>

        <!-- Hauptservice-Methoden -->
        <div class="methods-section">
            <h3>Hauptservice-Methoden</h3>

            <div class="method-card">
                <h4>getOrderById(Integer orderId)</h4>
                <p>Ruft Bestellung nach ID ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft Zugriff auf Bestellung √ºber isAccessToOrderAllowed()</div>
                    <div>‚Ä¢ Findet Bestellung nach ID, wenn nicht gefunden - wirft NotFoundException</div>
                    <div>‚Ä¢ Gibt OrderResponseDto √ºber OrderConverter zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getOrdersByUser(Integer userId)</h4>
                <p>Ruft Liste von Benutzerbestellungen ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft, dass userId nicht null ist</div>
                    <div>‚Ä¢ Findet Benutzer nach ID, wenn nicht gefunden - wirft NotFoundException</div>
                    <div>‚Ä¢ Pr√ºft, dass regul√§rer Benutzer nur eigene Bestellungen anfordert, sonst AccessDeniedException</div>
                    <div>‚Ä¢ Ruft Bestellliste √ºber OrderRepository ab</div>
                    <div>‚Ä¢ Gibt Liste von OrderResponseDto √ºber OrderConverter zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateOrderStatus(Integer orderId, String newStatus)</h4>
                <p>Aktualisiert Bestellstatus.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft Zugriff auf Bestellung √ºber isAccessToOrderAllowed()</div>
                    <div>‚Ä¢ Validiert, dass newStatus nicht null oder leer ist</div>
                    <div>‚Ä¢ Findet Bestellung nach ID, wenn nicht gefunden - wirft NotFoundException</div>
                    <div>‚Ä¢ Konvertiert String-Status zu Order.Status enum</div>
                    <div>‚Ä¢ Aktualisiert Status und speichert Bestellung</div>
                    <div>‚Ä¢ Gibt aktualisiertes OrderResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>cancelOrder(Integer orderId)</h4>
                <p>Storniert Bestellung.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft Zugriff auf Bestellung</div>
                    <div>‚Ä¢ Findet Bestellung nach ID, wenn nicht gefunden - wirft NotFoundException</div>
                    <div>‚Ä¢ Validiert, dass Bestellung in PENDING_PAYMENT-Status ist</div>
                    <div>‚Ä¢ Setzt Status auf CANCELLED und speichert</div>
                </div>
            </div>

            <div class="method-card">
                <h4>confirmPayment(Integer orderId, String paymentMethod)</h4>
                <p>Best√§tigt Bestellzahlung und sendet Best√§tigung per E-Mail.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Ruft aktuellen Benutzer ab</div>
                    <div>‚Ä¢ Findet Bestellung nach ID, pr√ºft, dass sie Benutzer geh√∂rt</div>
                    <div>‚Ä¢ Berechnet Bestellpreis basierend auf aktuellen Produktpreisen neu</div>
                    <div>‚Ä¢ Validiert Zahlungsmethode und Bestellstatus</div>
                    <div>‚Ä¢ Setzt Status auf PAID und speichert</div>
                    <div>‚Ä¢ Leert Warenkorb des Benutzers</div>
                    <div>‚Ä¢ Gibt OrderResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>updateOrderDelivery(Integer orderId, OrderRequestDto orderRequestDto)</h4>
                <p>Aktualisiert Lieferdetails der Bestellung.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft Zugriff auf Bestellung √ºber isAccessToOrderAllowed()</div>
                    <div>‚Ä¢ Validiert, dass Bestellung in PENDING_PAYMENT oder PAID Status ist</div>
                    <div>‚Ä¢ Validiert Lieferadresse und Kontakttelefon</div>
                    <div>‚Ä¢ Aktualisiert Liefermethode, Adresse und Telefon</div>
                    <div>‚Ä¢ Speichert aktualisierte Bestellung</div>
                    <div>‚Ä¢ Gibt aktualisiertes OrderResponseDto zur√ºck</div>
                </div>
            </div>

            <div class="method-card">
                <h4>getOrderStatusDto(Integer orderId)</h4>
                <p>Ruft Bestellstatusinformationen ab.</p>
                <div class="method-steps">
                    <div>‚Ä¢ Pr√ºft Zugriff auf Bestellung √ºber isAccessToOrderAllowed()</div>
                    <div>‚Ä¢ Findet Bestellung nach ID, wenn nicht gefunden - wirft NotFoundException</div>
                    <div>‚Ä¢ Gibt OrderStatusResponseDto mit Status und Aktualisierungszeitstempel zur√ºck</div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="endpoints-section">
            <h3>REST Endpoints</h3>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/orders/{orderId}</span>
                    <span class="role-badge role-user">USER</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Ruft Bestellung nach ID ab (Benutzer sehen nur eigene Bestellungen)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method get">GET</span>
                    <span class="endpoint-path">/v1/orders/ordersHistory/{userId}</span>
                    <span class="role-badge role-user">USER</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Ruft Bestellverlauf des Benutzers ab</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method delete">DELETE</span>
                    <span class="endpoint-path">/v1/orders/cancel/{orderId}</span>
                    <span class="role-badge role-user">USER</span>
                    <span class="role-badge role-admin">ADMIN</span>
                    <span class="role-badge role-manager">MANAGER</span>
                </div>
                <p>Storniert Bestellung (nur Bestellungen in PENDING_PAYMENT-Status)</p>
            </div>

            <div class="endpoint-detail">
                <div class="endpoint-header">
                    <span class="http-method post">POST</span>
                    <span class="endpoint-path">/v1/orders/confirm/{orderId}/{payMethod}</span>
                    <span class="role-badge role-user">USER</span>
                </div>
                <p>Best√§tigt Bestellzahlung mit E-Mail-Best√§tigungsversand</p>
            </div>
        </div>

        <!-- Implementierungsmerkmale -->
        <div class="features-section">
            <h3>üîß Implementierungsmerkmale</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Zugriffssicherheit:</strong> Benutzer sehen nur eigene Bestellungen, ADMIN/MANAGER haben Zugriff auf alle</div>
                    <div>‚Ä¢ <strong>Bestelllebenszyklus:</strong> Unterst√ºtzung f√ºr Status PENDING_PAYMENT, PAID, CANCELLED, DELIVERED</div>
                    <div>‚Ä¢ <strong>E-Mail-Benachrichtigungen:</strong> Automatischer Versand von Zahlungsbest√§tigungen mit PDF-Rechnung</div>
                    <div>‚Ä¢ <strong>Datenvalidierung:</strong> Validierung von Lieferdaten und Zahlungsmethodenkorrektheit</div>
                    <div>‚Ä¢ <strong>Fehlerbehandlung:</strong> Detaillierte Ausnahmen f√ºr verschiedene Fehlerszenarien</div>
                    <div>‚Ä¢ <strong>Zahlungsintegration:</strong> Unterst√ºtzung verschiedener Zahlungsmethoden (CREDIT_CARD, PAYPAL, BANK_TRANSFER)</div>
                    <div>‚Ä¢ <strong>Preisneuberechnung:</strong> Automatische Preisaktualisierung basierend auf aktuellen Produktpreisen und Rabatten</div>
                    <div>‚Ä¢ <strong>Warenkorb-Integration:</strong> Automatische Warenkorbleerung nach erfolgreicher Zahlung</div>
                </div>
            </div>
        </div>

        <!-- Gesch√§ftslogik -->
        <div class="business-logic-section">
            <h3>üíº Gesch√§ftslogik</h3>
            <div class="method-card">
                <div class="method-steps">
                    <div>‚Ä¢ <strong>Bestellstatus:</strong> Klarer Workflow von Status√§nderungen von Erstellung bis Abschluss</div>
                    <div>‚Ä¢ <strong>Feste Preise:</strong> Produktpreise werden zum Zeitpunkt der Zahlungsbest√§tigung neu berechnet</div>
                    <div>‚Ä¢ <strong>Automatisierung:</strong> PDF-Rechnungserstellung und E-Mail-Versand bei Zahlungsbest√§tigung</div>
                    <div>‚Ä¢ <strong>Audit:</strong> Speichern von Bestellungserstellungs- und Aktualisierungsdaten zur Verlaufverfolgung</div>
                    <div>‚Ä¢ <strong>Statusbeschr√§nkungen:</strong> Stornierung nur f√ºr Bestellungen in PENDING_PAYMENT-Status erlaubt</div>
                    <div>‚Ä¢ <strong>Lieferaktualisierungen:</strong> Lieferdetails k√∂nnen f√ºr Bestellungen in PENDING_PAYMENT und PAID Status aktualisiert werden</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" class="btn btn-primary">Schlie√üen</button>
    </div>
</div>